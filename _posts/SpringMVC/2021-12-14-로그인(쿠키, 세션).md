---
title:  "로그인-쿠키,세션"
excerpt: "스프링 MVC 2편 김영한"
categories:
  - Education
tag:
  - Spring
toc: true
---

## 패키지 구조 설계

- hello.login
  * domain
    * item
    * login
    * member
  * web
    * item
    * login
    * member

**도메인이 가장 중요하다.**  
도메인 : 화면, UI, 기술 인프라 등등의 영역은 제외한 시스템이 구현해야 하는 핵심 비즈니스 업무 영역을 말함

향후 web을 다른 기술로 바꾸어도 도메인은 그대로 유지할 수 있어야 한다.  
이렇게 하려면 web은 domain을 알고있지만 domain은 web을 모르도록 설계해야 한다. 이것을 web은 domain을 의존하지만, domain은 web을 의존하지 않는다고 표현한다.
web을 삭제해도 domain은 전혀 영향이 없도록 의존관계를 설계하는 것이 중요하다. domain은 web을 참조하면 안된다.



## 로그인
보통 로그인 기능을 구현할때 자바스크립트에서 1차적으로 검증을 하고 객체 변환시에 검증을 한번 더한다 그리고 난 후 BindeingResult에 결과를 담아 문제가 발생하면 다시 로그인 화면으로 
리다이렉트 시킨다.  
그런데 데이터의 경우 DB에 데이터를 직접 조회해서 검증을 해야 하는 경우가 있다. 검증에서 문제가 발생시 reject를 사용해서 글로벌 오류로 처리한다.

```java
@PostMapping("/login")
 public String login(@Valid @ModelAttribute LoginForm form, BindingResult 
bindingResult) {
 if (bindingResult.hasErrors()) {
 return "login/loginForm";
 }
 Member loginMember = loginService.login(form.getLoginId(),
form.getPassword());
 log.info("login? {}", loginMember);
 if (loginMember == null) {
 bindingResult.reject("loginFail", "아이디 또는 비밀번호가 맞지 않습니다.");
 return "login/loginForm";
 }
 //로그인 성공 처리 TODO
 return "redirect:/";
 }
}
```
### 로그인 처리하기 - 쿠키 사용
